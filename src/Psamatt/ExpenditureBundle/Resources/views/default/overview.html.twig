{% extends '::base.html.twig' %}

{% block content %}

	<p class="text-info">Fill out fields below to {{ defaultObj is defined? 'update':'add'}} a reoccuring monthly payment</p>
	<form method="post" action="{{ path('admin_payments_save') }}" class="form-horizontal" name="expenditureForm">
		{% if defaultObj is defined %}
			<input type="hidden" name="defaultID" value="{{ defaultObj.id }}" />
		{% endif %}
		<div class="control-group">
			<label class="control-label" for="inputTitle">Title</label>
			<div class="controls">
				<input type="text" id="inputTitle" name="inputTitle" placeholder="Title goes here.." {% if defaultObj is defined %}value="{{ defaultObj.title }}"{% endif %} />
			</div>
		</div>
		<div class="control-group">
			<label class="control-label" for="inputPrice">Price</label>
			<div class="controls">
				<div class="input-prepend">
					<span class="add-on">{{ CURRENCY }}</span>
					<input type="number" pattern="[0-9]+([,\.][0-9]+)?" step="0.01" min="0" id="inputPrice" name="inputPrice" placeholder="Price.." {% if defaultObj is defined %}value="{{ defaultObj.price }}"{% endif %} />
				</div>
			</div>
		</div>
		<div class="control-group">
			<div class="controls">
				<button type="submit" class="btn">{{ defaultObj is defined? 'Update':'Add'}}</button>
			</div>
		</div>
	</form>

	{% if monthlyTemplates | length > 0 %}
		{% set total = 0 %}
		<table class="table table-hover">
			<thead>
				<tr>
					<th>Title</th>
					<th>Price</th>
					<th width="20%">&nbsp;</th>
				</tr>
			</thead>
			<tbody>
				{% for monthlyTemplate in monthlyTemplates %}
					{% set total = total + monthlyTemplate.price %}
					<tr>
						<td>{{ monthlyTemplate.title }}</td>
						<td>{{ CURRENCY ~ monthlyTemplate.price | number_format(2, '.', ',') }}</td>
						<td>
							<a href="{{ path('admin_payments_delete', {'defaultID': monthlyTemplate.id}) }}" onclick="return confirm('Are you sure you want to delete this record?')" id="default_{{ monthlyTemplate.id }}_delete"><i class="icon-trash"></i> Delete</a></a>
							&nbsp;&nbsp;
							<a href="{{ path('admin_payments', {'defaultID': monthlyTemplate.id})}}"><i class="icon-pencil"></i> Edit</a>
						</td>
					</tr>
				{% endfor %}
			</tbody>
			<tfoot>
				<tr>
					<td><span class="pull-right"><strong>Total</strong></span></td>
					<td>{{ CURRENCY ~ total | number_format(2, '.', ',')}}</td>
					<td></td>
				</tr>
			</tfoot>
		</table>
	{% else %}
	   <p class="text-error">No default payments have been found</p>
	{% endif %}

{% endblock %}
